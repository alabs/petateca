{% extends "base.html" %}
{% load i18n %}
{% load thumbnail %}
{% load extract_domain %}
{% block extrastyle %}   
    <link rel="stylesheet" href="/static/css/jquery.rating.css" type="text/css" />{% endblock %}
{% block extrahead %}
    <script type="text/javascript" src="/static/js/jquery.MetaData.js"></script>
    <script type="text/javascript" src="/static/js/jquery.rating.js"></script>{% endblock %}
{% block contents %}
<div class="titulo_serie">{{ serie.name }}

    {% if favorite == "no" %}
  <form class="favorite" id="favorite" action="." method="POST">
    <input type="hidden" name="favorite" value="favorite"/>
    <input type="image" id="heart" src="/static/images/heart_black.png">
  </form>
  {% else %} {% if favorite == "yes" %}
  <form class="favorite" id="favorite" action="." method="POST">
    <input type="hidden" name="no-favorite" value="no-favorite"/>
    <input type="image" id="heart" src="/static/images/heart_red.png">
  </form>
    {% endif %}
    {% endif %}
    

  <div id="rating">
    <form action="." method="POST">
      <input type="radio" name="user_rating" value="1" class="star" {% if score == 1 %}checked="checked"{% endif %}/>
      <input type="radio" name="user_rating" value="2" class="star" {% if score == 2 %}checked="checked"{% endif %}/>
      <input type="radio" name="user_rating" value="3" class="star" {% if score == 3 %}checked="checked"{% endif %}/>
      <input type="radio" name="user_rating" value="4" class="star" {% if score == 4 %}checked="checked"{% endif %}/>
      <input type="radio" name="user_rating" value="5" class="star" {% if score == 5 %}checked="checked"{% endif %}/>
      <button type="submit">Rate</button>
    </form>{% spaceless %}
    {% if message == "No registrado" %}
      <div id="message_box" style="font-size:small;"><img id="close_message" style="float:right;cursor:pointer"  src="/static/img/close.png" />Debe <a href="/accounts/login/?next={{request.path}}">registrarse o iniciar sesion</a> para votar</div>
    {% else %}{% if message == "Vote recorded" %}
      <div id="message_box" style="font-size:small;"><img id="close_message" style="float:right;cursor:pointer"  src="/static/img/close.png" />Voto registrado</div>
    {% else %}{% if message == "You have already voted" %}
      <div id="message_box" style="font-size:small;"><img id="close_message" style="float:right;cursor:pointer"  src="/static/img/close.png" />Ya ha votado</div>
    {% else %}{% if message %}
      <div id="message_box" style="font-size:small;"><img id="close_message" style="float:right;cursor:pointer"  src="/static/img/close.png" />{{ message }}</div>
    {% endif %}
    {% endif %}
    {% endif %}
    {% endif %}
    {% if error %}
      <div class="error"> Couldn't vote :( </div>
    {% endif %}
  </div>{% endspaceless %}
  <br>
  {% if image %}{% thumbnail image "400x300" as img_serie %}
      <img id="poster" src="{{ img_serie.url }}" />{% endthumbnail %}
  {% else %}<div class="image_not_found"> 
            <img src="/static/images/image_not_available.png" height=100> 
 </div>
  {% endif %}
</div>

<br />
{# serie.rating_user_votes #}
{# serie.rating_user.get_percent #}

<ul>
  {% if serie.network.name %}
  <h2><li>{% trans "Network" %}:</h2> <a href="{{ serie.network.get_absolute_url }}">{{ serie.network.name }}</a></li>
  {% endif %}
  <li>
  <h2>{% trans "Genre" %}:</h2>
    <ul>
      {% for genre in serie.genres.all %}
      <li><a href="{{ genre.get_absolute_url}}">{{ genre.name }}</a></li>
      {% endfor %}
    </ul>
  </li>
  <li><h2>{% trans "Runtime" %}:</h2> {{ serie.runtime }} {% trans "minutes" %}</li>
  <li><h2>{% trans "Description" %}:</h2> {{ serie.description }}</li>
</ul>

<h2>{% trans "Seasons" %}: </h2>
  {% for season in season_list %}<br/> 
    <li><a href="{% url get_season serie_slug=serie.slug_name season=season %}">{% trans "Season" %} {{ season }}</a>
      {% endfor %}
     </table>
</ul>

  <h2>{% trans "Actors" %}:</h2>
    <ul>
        {% for actor in serie.actors.all %}   
          <li><a href={{ actor.get_absolute_url }}>{{ actor.name }}
               {% if actor.images.get %}{% thumbnail actor.images.get.src "280x280" as img_actor %}
                   <img id="actor_list" src="{{ img_actor.url }}" />{% endthumbnail %}
                   {% else %}<img id="actor_unknown" width="180" src="/static/images/image_not_available.png">
               {% endif %}
              </a> 
      {% endfor %}
    </ul>

<br />
<a href="{% url serie-index %}">{% trans "Series list" %}</a>
<br /> 
</a>
{% endblock %}
